<!DOCTYPE html>
<html>
		<head>
		</head>
		<body>
				<h2>Vulture Movie Fantasy League Scorecard</h2>
				This page gives a current estimate and breakdown of your Vulture MFL score, listing all sources of points by film. Due to minor errors, this may not be exactly the same as the score listed on the official MFL website.
				<form>
						<label for="uname">Username:</label>
						<input type="text" id="uname">
						<button type="button" onclick="changeScore(document.getElementById('uname').value)">Submit</button>
				</form>
				<h2 id='username'></h2>
				<h3 id='score'></h3>
				<h3 id='rank'></h3>
				<script>
					async function changeScore(name){
						const url = "./mfl_rosters.json"
						try {
							const response = await fetch(url)
							if(!response.ok){
								throw new Error(`Response status: ${response.status}`);
							}
							const json = await response.json()
							try {
								console.log(json[name])
								document.getElementById('username').innerHTML = 'Username: '+json[name]
								document.getElementById('score').innerHTML = 'Approximate score: '+json[name]['score_12_12']
								document.getElementById('rank').innerHTML = 'Approximate rank: '+json[name]['rank_12_12']
							} catch(error) {
								document.getElementById('username').innerHTML = 'Could not find your username.'
							}
						} catch(error){
							console.error(error.message);
						}

					}
				</script>

		</body>
</html>